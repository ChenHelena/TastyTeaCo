import{_ as E,m as N,b as S,r as c,o as m,c as u,d as e,e as r,w as g,F as U,h as D,t as n,i as B,bB as y,br as x,f as F,aw as p,g as R,bE as I,n as L}from"./index-ee3127fb.js";import{T as b,S as v,c as w}from"./cart-16a05450.js";const{VITE_URL:V,VITE_PATH:C}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"helena27",BASE_URL:"/TastyTeaCo/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},P={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:"88888"}},computed:{...N(w,["carts","cartNum"])},methods:{...S(w,["getCart"]),isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"須為正確的手機號碼 (ex：0912345678)"},addCouponCode(){if(this.cartNum){const t={code:this.coupon_code};this.$http.post(`${V}api/${C}/coupon`,{data:t}).then(()=>{b.fire({icon:"success",title:"套用優惠券"}),this.getCart(),this.coupon_code=""}).catch(s=>{var f,_;v.fire({icon:"error",title:(_=(f=s.response)==null?void 0:f.data)==null?void 0:_.message,confirmButtonColor:"#ab7e52"})})}else b.fire({icon:"warning",title:"請先選購產品"})},creatOrder(){const t=this.form;this.$http.post(`${V}api/${C}/order`,{data:t}).then(s=>{console.log(this.$route.params),b.fire({icon:"success",title:s.data.message}),this.$refs.form.resetForm(),this.form.message="",this.coupon_code="",this.getCart(),this.linkToPay(s.data.orderId)}).catch(()=>{this.cartNum===0?v.fire({icon:"error",title:"您尚未選購產品",text:"請您將產品加入購物車後，再次送出訂單，謝謝!",confirmButtonColor:"#482D0D"}):v.fire({icon:"error",title:"客戶資訊漏填",text:"請將客戶資訊填寫完整後，再次送出訂單，謝謝!",confirmButtonColor:"#482D0D"})})},linkToPay(t){this.$router.push(`/pay/${t}`)}},mounted(){this.getCart()}},$={class:"container my-6"},j={class:"row justify-content-center flex-lg-row flex-column-reverse"},q={class:"col-lg-6"},M=F('<div class="d-flex"><div class="text-tertiary active me-2"> 購物車 ⇀ </div><div class="text-secondary me-2"> 訂單資訊 ⇀ </div><div class="text-tertiary">結帳</div></div><div class="d-flex justify-content-between mb-3"><span class="fs-4">訂單資訊</span></div>',2),O={class:"mb-3"},A=e("label",{for:"email",class:"form-label"},"Email",-1),z={class:"mb-3"},H=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),G={class:"mb-3"},J=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),K={class:"mb-3"},Q=e("label",{for:"address",class:"form-label"},"收件人地址",-1),W={class:"mb-3"},X=e("label",{for:"message",class:"form-label"},"留言",-1),Y={class:"d-flex mt-4 justify-content-between align-items-md-center align-items-end w-100"},Z=e("div",{class:"pic pic1 me-2"},null,-1),ee={class:"text-end"},se={class:"col-lg-4"},te={class:"border p-4 mb-4 bg-light"},oe={class:"w-100"},le={class:"d-flex justify-content-between"},re={class:"mb-0 fw-bold"},ae={class:"mb-0"},ne={class:"mb-0 fw-bold"},ie={class:"table mt-4 border-top border-bottom text-muted"},de=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),ce={class:"text-end border-0 px-0 pt-4"},me={key:0},ue=e("th",{scope:"row",class:"border-0 px-0 pt-0 font-weight-normal"},"折扣金額",-1),pe={class:"text-end accent-color border-0 px-0 pt-0"},fe={class:"input-group mb-3 input-group-sm"},_e={class:"input-group-append"},he={class:"d-flex justify-content-between mt-4"},be=e("p",{class:"mb-0 h4 fw-bold"},"總計",-1),ve={class:"mb-0 h4 fw-bold"};function ge(t,s,f,_,l,h){const i=c("VField"),d=c("ErrorMessage"),k=c("RouterLink"),T=c("VForm");return m(),u("div",$,[e("div",j,[e("div",q,[M,r(T,{ref:"form"},{default:g(({errors:o})=>[e("div",O,[A,r(i,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),r(d,{name:"email",class:"invalid-feedback"})]),e("div",z,[H,r(i,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),r(d,{name:"姓名",class:"invalid-feedback"})]),e("div",G,[J,r(i,{id:"tel",name:"電話",type:"tel",class:p(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10|numeric",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),r(d,{name:"電話",class:"invalid-feedback"})]),e("div",K,[Q,r(i,{id:"address",name:"地址",type:"text",class:p(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),r(d,{name:"地址",class:"invalid-feedback"})]),e("div",W,[X,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=a=>l.form.message=a)},null,512),[[x,l.form.message]])]),e("div",Y,[e("div",null,[r(k,{to:"/carts",type:"button",class:"btn text-tertiary w-100 border-0 rounded-0 d-flex align-items-center goShop ps-0",style:{"box-shadow":"none"}},{default:g(()=>[Z,R(" 回購物車 ")]),_:1})]),e("div",ee,[e("button",{type:"button",onClick:s[5]||(s[5]=I(()=>h.creatOrder(),["prevent"])),class:"btn btn-primary w-100 border-0 rounded-0 px-5"}," 送出訂單 ")])])]),_:1},512)]),e("div",se,[e("div",te,[(m(!0),u(U,null,D(t.carts.carts,o=>(m(),u("div",{class:"d-flex mb-2",key:o.id},[e("div",{style:L([{width:"55px","max-height":"48px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.product.imageUrl})`}]),class:"rounded-0 me-3"},null,4),e("div",oe,[e("div",le,[e("p",re,n(o.product.title),1),e("p",ae,"NT$ "+n(o.product.price),1)]),e("p",ne,"x "+n(o.qty),1)])]))),128)),e("table",ie,[e("tbody",null,[e("tr",null,[de,e("td",ce,"NT$"+n(t.carts.total),1)]),t.carts.total!==t.carts.final_total?(m(),u("tr",me,[ue,e("td",pe,"-"+n(t.$filters.currency(t.carts.total-t.carts.final_total)),1)])):B("",!0)])]),e("div",fe,[y(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[6]||(s[6]=o=>l.coupon_code=o),placeholder:"請輸入優惠碼"},null,512),[[x,l.coupon_code]]),e("div",_e,[e("button",{class:"btn btn-outline-primary rounded-0",type:"button",onClick:s[7]||(s[7]=(...o)=>h.addCouponCode&&h.addCouponCode(...o))}," 套用優惠碼 ")])]),e("div",he,[be,e("p",ve,"NT$"+n(t.$filters.currency(t.carts.final_total)),1)])])])])])}const we=E(P,[["render",ge]]);export{we as default};
